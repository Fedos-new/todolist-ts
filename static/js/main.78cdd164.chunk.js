(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{104:function(t,e,a){},126:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a.n(n),o=a(8),r=a.n(o);a(104),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(63);var l,c,s,d=a(169),u=a(170),f=a(171),m=a(162),p=a(128),b=a(165),g=a(173),h=a(174),k=a(172),E=a(15),v=a(25),C=a(81),y=a.n(C).a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"api-key":"3c9a379c-5299-4637-abd2-f49a30f8dddb"}}),T=function(t,e){return y.put("todo-lists/".concat(t),{title:e})},j=function(){return y.get("todo-lists/").then((function(t){return t.data}))},O=function(t){return y.delete("todo-lists/".concat(t))},I=function(t){return y.post("todo-lists/",{title:t})},A=function(t,e,a){return y.put("todo-lists/".concat(t,"/tasks/").concat(e),a)},w=function(t){return y.get("todo-lists/".concat(t,"/tasks"))},S=function(t,e){return y.delete("todo-lists/".concat(t,"/tasks/").concat(e))},x=function(t,e){return y.post("todo-lists/".concat(t,"/tasks"),{title:e})},L=function(t){return y.post("auth/login",t)},F=function(){return y.get("auth/me")},N=function(){return y.delete("auth/login")};!function(t){t[t.New=0]="New",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed",t[t.Draft=3]="Draft"}(l||(l={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.Hi=2]="Hi",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(c||(c={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.Hi=2]="Hi",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(s||(s={}));var P=function(t,e){t.messages.length?e(J({error:t.messages[0]})):e(J({error:"Some error occurred"})),e(Z({status:"failed"}))},z=function(t,e){e(J({error:t.message})),e(Z({status:"failed"}))},M=a(26),D=Object(M.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedInAC:function(t,e){t.isLoggedIn=e.payload.value}}}),H=D.reducer,R=D.actions.setIsLoggedInAC,U=Object(M.b)({name:"app",initialState:{status:"idle",error:null,isInitialized:!1},reducers:{setAppStatusAC:function(t,e){t.status=e.payload.status},setAppErrorAC:function(t,e){t.error=e.payload.error},setAppInitializedAC:function(t,e){t.isInitialized=e.payload.isInitialized}}}),q=U.reducer,B=U.actions,Z=B.setAppStatusAC,J=B.setAppErrorAC,W=B.setAppInitializedAC,$=Object(M.b)({name:"task",initialState:[],reducers:{removeTodolistAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todolistId}));a>-1&&t.splice(a,1)},addTodolistAC:function(t,e){t.unshift(Object(v.a)(Object(v.a)({},e.payload.todolist),{},{filter:"all",entityStatus:"idle"}))},changeTodolistTitleAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todolistId}));t[a].title=e.payload.title},changeTodolistFilterAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));t[a].filter=e.payload.filter},setTodolistsAC:function(t,e){return e.payload.todolists.map((function(t){return Object(v.a)(Object(v.a)({},t),{},{filter:"all",entityStatus:"idle"})}))},changeTodolistEntityStatusAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todolistId}));t[a].entityStatus=e.payload.entityStatus,t.map((function(t){return t.id===e.payload.todolistId?Object(v.a)(Object(v.a)({},t),{},{entityStatus:e.payload.entityStatus}):t}))}}}),_=$.reducer,K=$.actions,V=K.removeTodolistAC,G=K.addTodolistAC,Q=K.changeTodolistTitleAC,X=K.changeTodolistFilterAC,Y=K.changeTodolistEntityStatusAC,tt=K.setTodolistsAC,et=Object(M.b)({name:"task",initialState:{},reducers:{removeTaskAC:function(t,e){var a=t[e.payload.todolistId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));n>-1&&a.splice(n,1)},addTaskAC:function(t,e){t[e.payload.task.todoListId].unshift(e.payload.task)},updateTaskAC:function(t,e){var a=t[e.payload.todolistId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));n>-1&&(a[n]=Object(v.a)(Object(v.a)({},a[n]),e.payload.model))},setTasksAC:function(t,e){t[e.payload.todolistId]=e.payload.tasks}},extraReducers:function(t){t.addCase(G,(function(t,e){t[e.payload.todolist.id]=[]})),t.addCase(V,(function(t,e){delete t[e.payload.todolistId]})),t.addCase(tt,(function(t,e){e.payload.todolists.forEach((function(e){t[e.id]=[]}))}))}}),at=et.reducer,nt=et.actions,it=nt.removeTaskAC,ot=nt.addTaskAC,rt=nt.updateTaskAC,lt=nt.setTasksAC,ct=function(t,e,a){return function(n,i){var o=i().tasks[a].find((function(e){return e.id===t}));if(o){var r=Object(v.a)({deadline:o.deadline,description:o.description,priority:o.priority,startDate:o.startDate,title:o.title,status:o.status},e);n(Z({status:"loading"})),A(a,t,r).then((function(i){0===i.data.resultCode?n(rt({taskId:t,model:e,todolistId:a})):P(i.data,n),n(Z({status:"succeeded"}))})).catch((function(t){z(t,n)}))}else console.warn("task not found in the state")}},st=a(166),dt=a(127),ut=a(45),ft=a(175),mt=a(163),pt=i.a.memo((function(t){console.log("AddItemForm called");var e=Object(n.useState)(""),a=Object(ut.a)(e,2),o=a[0],r=a[1],l=Object(n.useState)(null),c=Object(ut.a)(l,2),s=c[0],d=c[1],u=function(){""!==o.trim()?(t.addItem(o),r("")):d("Title is required")};return i.a.createElement("div",null,i.a.createElement(ft.a,{value:o,variant:"outlined",onChange:function(t){r(t.currentTarget.value)},onKeyPress:function(t){null!==s&&d(null),13===t.charCode&&u()},error:!!s,helperText:s,disabled:"loading"===t.entityStatus}),i.a.createElement(m.a,{onClick:u,color:"primary",disabled:"loading"===t.entityStatus},i.a.createElement(mt.a,null)))})),bt=i.a.memo((function(t){console.log("EditableSpan is called");var e=Object(n.useState)(!1),a=Object(ut.a)(e,2),o=a[0],r=a[1],l=Object(n.useState)(t.title),c=Object(ut.a)(l,2),s=c[0],d=c[1];return o?i.a.createElement(ft.a,{value:s,onBlur:function(){r(!1),t.saveNewTitle(s)},autoFocus:!0,onChange:function(t){d(t.currentTarget.value)}}):i.a.createElement("span",{onDoubleClick:function(){r(!0),d(t.title)}},t.title)})),gt=a(164),ht=a(177),kt=i.a.memo((function(t){var e=Object(n.useCallback)((function(e){t.changeTaskTitle(t.task.id,e,t.todolistId)}),[t.changeTaskTitle,t.task.id,t.todolistId]);return i.a.createElement("div",{key:t.task.id,className:t.task.status===l.Completed?"is-done":""},i.a.createElement(ht.a,{checked:t.task.status===l.Completed,onChange:function(e){t.changeTaskStatus(t.task.id,e.currentTarget.checked?l.Completed:l.New,t.todolistId)}}),i.a.createElement(bt,{title:t.task.title,saveNewTitle:e}),i.a.createElement(m.a,{onClick:function(){return t.removeTask(t.task.id,t.todolistId)},color:"primary"},i.a.createElement(gt.a,null)))})),Et=i.a.memo((function(t){console.log("Todolist is called");var e=Object(E.b)();Object(n.useEffect)((function(){var a;e((a=t.id,function(t){t(Z({status:"loading"})),w(a).then((function(e){var n=e.data.items,i=lt({tasks:n,todolistId:a});t(i),t(Z({status:"succeeded"}))}))}))}),[]);var a=Object(n.useCallback)((function(e){t.addTasks(e,t.id)}),[t.addTasks,t.id]),o=Object(n.useCallback)((function(){return t.removeTodolist(t.id)}),[t.id,t.removeTodolist]),r=Object(n.useCallback)((function(e){t.changeTodolistTitle(t.id,e)}),[t.id,t.changeTodolistTitle]),c=Object(n.useCallback)((function(){return t.changeFilter("all",t.id)}),[t.changeFilter,t.id]),s=Object(n.useCallback)((function(){return t.changeFilter("active",t.id)}),[t.changeFilter,t.id]),d=Object(n.useCallback)((function(){return t.changeFilter("completed",t.id)}),[t.changeFilter,t.id]),u=t.tasks;return"active"===t.filter&&(u=t.tasks.filter((function(t){return t.status===l.New}))),"completed"===t.filter&&(u=t.tasks.filter((function(t){return t.status===l.Completed}))),i.a.createElement("div",{className:"App"},i.a.createElement("div",null,i.a.createElement("h3",null,i.a.createElement(bt,{title:t.title,saveNewTitle:r}),i.a.createElement(m.a,{onClick:o,disabled:"loading"===t.entityStatus},i.a.createElement(gt.a,null))),i.a.createElement(pt,{addItem:a,entityStatus:t.entityStatus}),i.a.createElement("ul",null,u.map((function(e){return i.a.createElement(kt,{task:e,changeTaskStatus:t.changeTaskStatus,changeTaskTitle:t.changeTaskTitle,removeTask:t.removeTask,todolistId:t.id,key:e.id})}))),i.a.createElement("div",null,i.a.createElement(b.a,{variant:"all"===t.filter?"contained":"text",onClick:c},"All"),i.a.createElement(b.a,{color:"primary",variant:"active"===t.filter?"contained":"text",onClick:s},"Active"),i.a.createElement(b.a,{color:"secondary",variant:"completed"===t.filter?"contained":"text",onClick:d},"Completed"))))})),vt=a(12),Ct=function(t){var e=Object(E.c)((function(t){return t.todolists})),a=Object(E.c)((function(t){return t.tasks})),o=Object(E.b)(),r=Object(E.c)((function(t){return t.auth.isLoggedIn}));Object(n.useEffect)((function(){r&&o((function(t){t(Z({status:"loading"})),j().then((function(e){t(tt({todolists:e})),t(Z({status:"succeeded"}))}))}))}),[]);var l=Object(n.useCallback)((function(t,e){var a=function(t,e){return function(a){a(Z({status:"loading"})),S(e,t).then((function(n){0===n.data.resultCode?a(it({taskId:t,todolistId:e})):P(n.data,a),a(Z({status:"succeeded"}))})).catch((function(t){z(t,a)}))}}(t,e);o(a)}),[]),c=Object(n.useCallback)((function(t,e){var a=X({filter:t,id:e});o(a)}),[]),s=Object(n.useCallback)((function(t,e){var a=function(t,e){return function(a){a(Z({status:"loading"})),x(e,t).then((function(t){0===t.data.resultCode?a(ot({task:t.data.data.item})):P(t.data,a),a(Z({status:"succeeded"}))})).catch((function(t){z(t,a)}))}}(t,e);o(a)}),[]),d=Object(n.useCallback)((function(t,e,a){var n=ct(t,{status:e},a);o(n)}),[]),u=Object(n.useCallback)((function(t){var e=function(t){return function(e){e(Z({status:"loading"})),I(t).then((function(t){0===t.data.resultCode?e(G({todolist:t.data.data.item})):P(t.data,e),e(Z({status:"succeeded"}))})).catch((function(t){z(t,e)}))}}(t);o(e)}),[]),f=Object(n.useCallback)((function(t,e,a){var n=ct(t,{title:e},a);o(n)}),[]),m=Object(n.useCallback)((function(t){var e=function(t){return function(e){e(Z({status:"loading"})),e(Y({todolistId:t,entityStatus:"loading"})),O(t).then((function(a){0===a.data.resultCode?e(V({todolistId:t})):P(a.data,e),e(Z({status:"succeeded"}))})).catch((function(t){z(t,e)}))}}(t);o(e)}),[]),p=Object(n.useCallback)((function(t,e){var a=function(t,e){return function(a){a(Z({status:"loading"})),T(t,e).then((function(n){a(Q({todolistId:t,title:e})),a(Z({status:"succeeded"}))})).catch((function(t){z(t,a)}))}}(t,e);o(a)}),[]);return r?i.a.createElement(i.a.Fragment,null,i.a.createElement(st.a,{container:!0,style:{padding:"20px"}},i.a.createElement(pt,{addItem:u,entityStatus:"idle"})),i.a.createElement(st.a,{container:!0,spacing:3},e.map((function(t){var e=a[t.id];return i.a.createElement(st.a,{item:!0},i.a.createElement(dt.a,{style:{padding:"10px"}},i.a.createElement(Et,{key:t.id,id:t.id,title:t.title,entityStatus:t.entityStatus,tasks:e,removeTask:l,changeFilter:c,addTasks:s,changeTaskStatus:d,filter:t.filter,removeTodolist:m,changeTaskTitle:f,changeTodolistTitle:p})))})))):i.a.createElement(vt.a,{to:"/login"})},yt=a(179),Tt=a(176);function jt(t){return i.a.createElement(Tt.a,Object.assign({elevation:6,variant:"filled"},t))}function Ot(){var t=Object(E.c)((function(t){return t.app.error})),e=Object(E.b)(),a=function(t,a){"clickaway"!==a&&e(J({error:null}))};return i.a.createElement(yt.a,{open:null!==t,autoHideDuration:6e3,onClose:a},i.a.createElement(jt,{onClose:a,severity:"error"},t))}var It=a(180),At=a(161),wt=a(167),St=a(168),xt=a(87),Lt=function(){var t=Object(E.b)(),e=Object(E.c)((function(t){return t.auth.isLoggedIn})),a=Object(xt.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(t){var e={};return t.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(t.email)||(e.email="Invalid email address"):e.email="Required",t.password?t.password.length<3&&(e.password="Must be more 3 characters"):e.password="Required",e},onSubmit:function(e){var a;t((a=e,function(t){t(Z({status:"loading"})),L(a).then((function(e){0===e.data.resultCode?t(R({value:!0})):P(e.data,t),t(Z({status:"succeeded"}))})).catch((function(e){z(e,t)}))}))}});return e?i.a.createElement(vt.a,{to:"/"}):i.a.createElement(st.a,{container:!0,justify:"center"},i.a.createElement(st.a,{item:!0,xs:4},i.a.createElement("form",{onSubmit:a.handleSubmit},i.a.createElement(It.a,null,i.a.createElement(At.a,null,i.a.createElement("p",null,"To log in get registered\xa0",i.a.createElement("a",{href:"https://social-network.samuraijs.com/",target:"_blank"},"here")),i.a.createElement("p",null,"or use common test account credentials:"),i.a.createElement("p",null,"Email: free@samuraijs.com"),i.a.createElement("p",null,"Password: free")),i.a.createElement(wt.a,null,i.a.createElement(ft.a,Object.assign({label:"Email",margin:"normal"},a.getFieldProps("email"))),a.touched.email&&a.errors.email?i.a.createElement("div",{style:{color:"red"}},a.errors.email):null,i.a.createElement(ft.a,Object.assign({type:"password",label:"Password",margin:"normal"},a.getFieldProps("password"))),a.touched.password&&a.errors.password?i.a.createElement("div",{style:{color:"red"}},a.errors.password):null,i.a.createElement(St.a,{label:"Remember me",control:i.a.createElement(ht.a,a.getFieldProps("rememberMe"))}),i.a.createElement(b.a,{type:"submit",variant:"contained",color:"primary"},"Login"))))))};var Ft=function(){var t=Object(E.c)((function(t){return t.app.status})),e=Object(E.c)((function(t){return t.app.isInitialized})),a=Object(E.b)();return Object(n.useEffect)((function(){a((function(t){F().then((function(e){0===e.data.resultCode&&t(R({value:!0})),t(W({isInitialized:!0}))})).catch((function(e){t(W({isInitialized:!0})),z(e,t)}))}))}),[]),e?i.a.createElement("div",{className:"App"},i.a.createElement(Ot,null),i.a.createElement(u.a,{position:"static",className:"bar"},i.a.createElement(f.a,null,i.a.createElement(m.a,{edge:"start",color:"inherit","aria-label":"menu"},i.a.createElement(k.a,null)),i.a.createElement(p.a,{variant:"h6"},"TodoList"),e&&i.a.createElement(b.a,{color:"inherit",onClick:function(){a((function(t){t(Z({status:"loading"})),N().then((function(e){0===e.data.resultCode?(t(R({value:!1})),t(Z({status:"succeeded"}))):P(e.data,t)})).catch((function(e){z(e,t)}))}))}},"Log out"))),"loading"===t&&i.a.createElement(g.a,{color:"secondary"}),i.a.createElement(h.a,{fixed:!0},i.a.createElement(vt.d,null,i.a.createElement(vt.b,{exact:!0,path:"/",render:function(){return i.a.createElement(Ct,null)}}),i.a.createElement(vt.b,{exact:!0,path:"/login",render:function(){return i.a.createElement(Lt,null)}}),i.a.createElement(vt.b,{path:"/404",render:function(){return i.a.createElement("h1",null,"Page Not Found - Error 404")}}),i.a.createElement(vt.a,{from:"/*",to:"/404"})))):i.a.createElement("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"}},i.a.createElement(d.a,null))},Nt=a(21),Pt=a(48),zt=Object(Nt.c)({tasks:at,todolists:_,app:q,auth:H}),Mt=Object(M.a)({reducer:zt,middleware:function(t){return t().prepend(Pt.a)}});window.store=Mt;var Dt=a(47);r.a.render(i.a.createElement(E.a,{store:Mt},i.a.createElement(Dt.a,null,i.a.createElement(Ft,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},63:function(t,e,a){},99:function(t,e,a){t.exports=a(126)}},[[99,1,2]]]);
//# sourceMappingURL=main.78cdd164.chunk.js.map